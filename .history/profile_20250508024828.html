<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CloudClips Clone ‚Äì Profile</title>
  <link rel="stylesheet" href="styles.css"/>
  <script src="dashboard.js" defer></script>
</head>
<body>
  <header class="container">
    <h1>My Profile</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="profile.html">Profile</a>
      <a href="upload.html">Upload</a>
      <a href="signin.html">Sign In</a>
    </nav>
  </header>

  <main class="container">
    <section id="userInfo">
      <h2 id="usernameDisplay"></h2>
      <p id="emailDisplay"></p>
    </section>

    <section class="feed" id="myPosts"></section>
  </main>

  <footer class="container">&copy; 2025 CloudClips Clone</footer>

  <script>
    // Display user info
    const user = JSON.parse(localStorage.getItem('loggedInUser'));
    if (!user) return window.location.href = 'signin.html';
    document.getElementById('usernameDisplay').textContent = `${user.firstName} ${user.lastName}`;
    document.getElementById('emailDisplay').textContent    = user.email;

    // Re‚Äêuse renderPosts from home, but only show this user's posts
    function renderPosts(containerId, onlyUserPosts = false) {
      const container = document.getElementById(containerId);
      const posts     = JSON.parse(localStorage.getItem('posts')) || [];
      const list      = onlyUserPosts
        ? posts.filter(p => p.userEmail === user.email)
        : posts;

      if (!list.length) {
        container.innerHTML = '<p>No posts yet.</p>';
        return;
      }

      container.innerHTML = list.map((p, i) => {
        const globalIndex = posts.indexOf(p);
        return `
          <div class="post">
            <h3>${p.title || 'Untitled'}</h3>
            ${p.type.startsWith('video')
              ? `<video controls><source src="${p.media}" type="${p.type}"></video>`
              : `<img src="${p.media}" alt="">`
            }
            <p>${p.description}</p>
            <div class="actions">
              <button onclick="likePost(${globalIndex})">‚ù§Ô∏è ${p.likes}</button>
              <button onclick="sharePost(${globalIndex})" title="Share">üîó</button>
              <button onclick="savePost(${globalIndex})" title="Save">üíæ</button>
            </div>
          </div>
        `;
      }).join('');
    }

    document.addEventListener('DOMContentLoaded', () => {
      renderPosts('myPosts', true);
    });
  </script>
</body>
</html>
